#!/usr/bin/env node

var fs = require('fs');
var program = require('commander');
var prompt = require('prompt');
var pkg = require('../package.json');
var Modinit = require('../');

program.version(pkg.version)

program
  .command('create')
  .description('create .modinitrc')
  .action(function () {
    prompt.message = '[?]'.magenta;
    prompt.delimiter = ':';

    prompt.start();

    prompt.get({
      properties: {
        github: {
          description: "GitHub username".magenta
        },
        author: {
          description: "Author".magenta
        },
        mail: {
          description: "Mail".magenta
        },
        testfw: {
          description: "Testing framework".magenta
        },
        travis: {
          description: "Use travis?(Y/n)".magenta,
          default: 'Y'
        },
        readme: {
          description: "README style".magenta,
          default: 'README.md'
        },
        license: {
          description: "License".magenta,
          default: 'MIT'
        }
      }
    }, function (err, result) {
      if (err) console.log(err);

      var modinit = new Modinit(result);
      var modinitrc = modinit.create();
      if (modinitrc) {
        console.log("");
        console.log("GitHub username: " + result.github.cyan);
        console.log("Author: " + result.author.cyan);
        console.log("Mail: " + result.mail.cyan);
        console.log("Testing framework: " + result.testfw.cyan);
        console.log("Use travis: " + result.travis.cyan);
        console.log("README style: " + result.readme.cyan);
        console.log("License: " + result.license.cyan);

        fs.writeFile('modinit.json', JSON.stringify(modinitrc, null, " "), function (err) {
          if (err) console.log(err);
          else {
            console.log("");
            console.log("Success! Create '.modinitrc'".green);
          }
        });
      }
    });
  });

program.parse(process.argv);
